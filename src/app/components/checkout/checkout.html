<section class="checkout-page">
  <div class="checkout-grid">
    <div class="left-panel">
      <div *ngIf="items.length === 0" class="empty">Your cart is empty.</div>
      <div *ngFor="let item of items" class="cart-line">
        <img [src]="item.product.url" [alt]="item.product.name" class="thumb">
        <div>
          <h3>{{ item.product.name }}</h3>
          <p class="price">{{ item.product.price | currency }}</p>
          <div class="qty-row">
            <label class="field-label" for="qty-{{ item.product.id }}">Amount:</label>
            <input
              id="qty-{{ item.product.id }}"
              type="number"
              class="input small"
              min="1"
              [(ngModel)]="item.quantity"
              (ngModelChange)="updateQuantity(item.product.id, $event)"
            >
          </div>
        </div>
      </div>
      <div class="total-row">
        <span>Total:</span>
        <strong>{{ total | currency }}</strong>
      </div>
    </div>

    <form class="form" #checkoutForm="ngForm" (ngSubmit)="submitOrder(checkoutForm)">
      <label class="field-label" for="name">Full name</label>
      <input
        id="name"
        class="input"
        [(ngModel)]="name"
        name="name"
        required
        minlength="3"
        placeholder="(minimum 3 characters)"
      >
      <p class="error" *ngIf="checkoutForm.submitted && checkoutForm.controls['name']?.invalid">
        Name is required (min 3 characters).
      </p>

      <label class="field-label" for="address">Address</label>
      <input
        id="address"
        class="input"
        [(ngModel)]="address"
        name="address"
        required
        minlength="6"
        placeholder="(minimum 6 characters)"
      >
      <p class="error" *ngIf="checkoutForm.submitted && checkoutForm.controls['address']?.invalid">
        Address is required.
      </p>

      <label class="field-label" for="card">Credit card number</label>
      <input
        id="card"
        class="input"
        [(ngModel)]="card"
        name="card"
        required
        inputmode="numeric"
        maxlength="19"
        placeholder="(16-digit number)"
      >
      <p class="error" *ngIf="submissionError === 'card'">Enter a 16-digit card number.</p>

      <p class="note">We'll never share your payment details with anyone else.</p>

      <div class="form-footer">
        <p class="error" *ngIf="submissionError">{{ submissionError }}</p>
        <button
          type="submit"
          class="btn primary full"
        >
          Submit
        </button>
      </div>
    </form>
  </div>
</section>
